<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://lainbo.github.io/</id>
    <title>Gridea</title>
    <updated>2019-11-29T02:52:46.494Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://lainbo.github.io/"/>
    <link rel="self" href="https://lainbo.github.io//atom.xml"/>
    <subtitle>æ¸©æ•…è€ŒçŸ¥æ–°</subtitle>
    <logo>https://lainbo.github.io//images/avatar.png</logo>
    <icon>https://lainbo.github.io//favicon.ico</icon>
    <rights>All rights reserved 2019, Gridea</rights>
    <entry>
        <title type="html"><![CDATA[è¯·æ±‚ã€å¼‚æ­¥]]></title>
        <id>https://lainbo.github.io//post/qing-qiu-yi-bu</id>
        <link href="https://lainbo.github.io//post/qing-qiu-yi-bu">
        </link>
        <updated>2019-11-29T02:32:09.000Z</updated>
        <content type="html"><![CDATA[<h3 id="æ¥å£è°ƒç”¨æ–¹å¼">æ¥å£è°ƒç”¨æ–¹å¼</h3>
<ul>
<li>åŸç”Ÿajax</li>
<li>åŸºäºjQueryçš„ajax</li>
<li>fetch</li>
<li>axios</li>
</ul>
<h3 id="å¼‚æ­¥">å¼‚æ­¥</h3>
<ul>
<li>JavaScriptçš„æ‰§è¡Œç¯å¢ƒæ˜¯ã€Œå•çº¿ç¨‹ã€</li>
<li>æ‰€è°“å•çº¿ç¨‹ï¼Œæ˜¯æŒ‡JSå¼•æ“ä¸­è´Ÿè´£è§£é‡Šå’Œæ‰§è¡ŒJavaScriptä»£ç çš„çº¿ç¨‹åªæœ‰ä¸€ä¸ªï¼Œä¹Ÿå°±æ˜¯ä¸€æ¬¡åªèƒ½å®Œæˆä¸€é¡¹ä»»åŠ¡ï¼Œè¿™ä¸ªä»»åŠ¡æ‰§è¡Œå®Œåæ‰èƒ½æ‰§è¡Œä¸‹ä¸€ä¸ªï¼Œå®ƒä¼šã€Œé˜»å¡ã€å…¶ä»–ä»»åŠ¡ã€‚è¿™ä¸ªä»»åŠ¡å¯ç§°ä¸ºä¸»çº¿ç¨‹</li>
<li>å¼‚æ­¥æ¨¡å¼å¯ä»¥ä¸€èµ·æ‰§è¡Œ<strong>å¤šä¸ªä»»åŠ¡</strong></li>
<li>JSä¸­å¸¸è§çš„å¼‚æ­¥è°ƒç”¨
<ul>
<li>å®šæ—¶ä»»ä½•</li>
<li>ajax</li>
<li>äº‹ä»¶å‡½æ•°</li>
</ul>
</li>
</ul>
<h3 id="promise">promise</h3>
<ul>
<li>ä¸»è¦è§£å†³å¼‚æ­¥æ·±å±‚åµŒå¥—çš„é—®é¢˜</li>
<li>promise æä¾›äº†ç®€æ´çš„API  ä½¿å¾—å¼‚æ­¥æ“ä½œæ›´åŠ å®¹æ˜“</li>
</ul>
<pre><code class="language-html"> 
  &lt;script type=&quot;text/javascript&quot;&gt;
    /*
     1. PromiseåŸºæœ¬ä½¿ç”¨
           æˆ‘ä»¬ä½¿ç”¨newæ¥æ„å»ºä¸€ä¸ªPromise  Promiseçš„æ„é€ å‡½æ•°æ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œæ˜¯å‡½æ•°ï¼Œå¹¶ä¸”ä¼ å…¥ä¸¤ä¸ªå‚æ•°ï¼š		   resolveï¼Œrejectï¼Œ åˆ†åˆ«è¡¨ç¤ºå¼‚æ­¥æ“ä½œæ‰§è¡ŒæˆåŠŸåçš„å›è°ƒå‡½æ•°å’Œå¼‚æ­¥æ“ä½œæ‰§è¡Œå¤±è´¥åçš„å›è°ƒå‡½æ•°
    */


    var p = new Promise(function(resolve, reject){
      //2. è¿™é‡Œç”¨äºå®ç°å¼‚æ­¥ä»»åŠ¡  setTimeout
      setTimeout(function(){
        var flag = false;
        if(flag) {
          //3. æ­£å¸¸æƒ…å†µ
          resolve('hello');
        }else{
          //4. å¼‚å¸¸æƒ…å†µ
          reject('å‡ºé”™äº†');
        }
      }, 100);
    });
    //  5 Promiseå®ä¾‹ç”Ÿæˆä»¥åï¼Œå¯ä»¥ç”¨thenæ–¹æ³•æŒ‡å®šresolvedçŠ¶æ€å’ŒrejectçŠ¶æ€çš„å›è°ƒå‡½æ•° 
    //  åœ¨thenæ–¹æ³•ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥returnæ•°æ®è€Œä¸æ˜¯Promiseå¯¹è±¡ï¼Œåœ¨åé¢çš„thenä¸­å°±å¯ä»¥æ¥æ”¶åˆ°æ•°æ®äº†  
    p.then(function(data){
      console.log(data)
    },function(info){
      console.log(info)
    });
  &lt;/script&gt;
</code></pre>
<h3 id="åŸºäºpromiseå‘é€ajaxè¯·æ±‚">åŸºäºPromiseå‘é€Ajaxè¯·æ±‚</h3>
<pre><code class="language-html"> 
  &lt;script type=&quot;text/javascript&quot;&gt;
    /*
      åŸºäºPromiseå‘é€Ajaxè¯·æ±‚
    */
    function queryData(url) {
     #   1.1 åˆ›å»ºä¸€ä¸ªPromiseå®ä¾‹
      var p = new Promise(function(resolve, reject){
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function(){
          if(xhr.readyState != 4) return;
          if(xhr.readyState == 4 &amp;&amp; xhr.status == 200) {
            # 1.2 å¤„ç†æ­£å¸¸çš„æƒ…å†µ
            resolve(xhr.responseText);
          }else{
            # 1.3 å¤„ç†å¼‚å¸¸æƒ…å†µ
            reject('æœåŠ¡å™¨é”™è¯¯');
          }
        };
        xhr.open('get', url);
        xhr.send(null);
      });
      return p;
    }
	# æ³¨æ„ï¼š  è¿™é‡Œéœ€è¦å¼€å¯ä¸€ä¸ªæœåŠ¡ 
    # åœ¨thenæ–¹æ³•ä¸­ï¼Œä½ ä¹Ÿå¯ä»¥ç›´æ¥returnæ•°æ®è€Œä¸æ˜¯Promiseå¯¹è±¡ï¼Œåœ¨åé¢çš„thenä¸­å°±å¯ä»¥æ¥æ”¶åˆ°æ•°æ®äº†
    queryData('http://localhost:3000/data')
      .then(function(data){
        console.log(data)
        #  1.4 æƒ³è¦ç»§ç»­é“¾å¼ç¼–ç¨‹ä¸‹å» éœ€è¦ return  
        return queryData('http://localhost:3000/data1');
      })
      .then(function(data){
        console.log(data);
        return queryData('http://localhost:3000/data2');
      })
      .then(function(data){
        console.log(data)
      });
  &lt;/script&gt;
</code></pre>
<h3 id="promise-åŸºæœ¬api">Promise  åŸºæœ¬API</h3>
<h4 id="å®ä¾‹æ–¹æ³•">å®ä¾‹æ–¹æ³•</h4>
<h5 id="then">.then()</h5>
<ul>
<li>å¾—åˆ°å¼‚æ­¥ä»»åŠ¡æ­£ç¡®çš„ç»“æœ</li>
</ul>
<h5 id="catch">.catch()</h5>
<ul>
<li>è·å–å¼‚å¸¸ä¿¡æ¯</li>
</ul>
<h5 id="finally">.finally()</h5>
<ul>
<li>æˆåŠŸä¸å¦éƒ½ä¼šæ‰§è¡Œï¼ˆä¸æ˜¯æ­£å¼æ ‡å‡†ï¼‰</li>
</ul>
<pre><code class="language-html">  
  &lt;script type=&quot;text/javascript&quot;&gt;
    /*
      Promiseå¸¸ç”¨API-å®ä¾‹æ–¹æ³•
    */
    // console.dir(Promise);
    function foo() {
      return new Promise(function(resolve, reject){
        setTimeout(function(){
          // resolve(123);
          reject('error');
        }, 100);
      })
    }
    // foo()
    //   .then(function(data){
    //     console.log(data)
    //   })
    //   .catch(function(data){
    //     console.log(data)
    //   })
    //   .finally(function(){
    //     console.log('finished')
    //   });

    // --------------------------
    // ä¸¤ç§å†™æ³•æ˜¯ç­‰æ•ˆçš„
    foo()
      .then(function(data){
        # å¾—åˆ°å¼‚æ­¥ä»»åŠ¡æ­£ç¡®çš„ç»“æœ
        console.log(data)
      },function(data){
        # è·å–å¼‚å¸¸ä¿¡æ¯
        console.log(data)
      })
      # æˆåŠŸä¸å¦éƒ½ä¼šæ‰§è¡Œï¼ˆä¸æ˜¯æ­£å¼æ ‡å‡†ï¼‰ 
      .finally(function(){
        console.log('finished')
      });
  &lt;/script&gt;
</code></pre>
<h4 id="é™æ€æ–¹æ³•">é™æ€æ–¹æ³•</h4>
<h5 id="all">.all()</h5>
<ul>
<li><code>Promise.all</code>æ–¹æ³•æ¥å—ä¸€ä¸ªæ•°ç»„ä½œå‚æ•°ï¼Œæ•°ç»„ä¸­çš„å¯¹è±¡ï¼ˆp1ã€p2ã€p3ï¼‰å‡ä¸ºpromiseå®ä¾‹ï¼ˆå¦‚æœä¸æ˜¯ä¸€ä¸ªpromiseï¼Œè¯¥é¡¹ä¼šè¢«ç”¨<code>Promise.resolve</code>è½¬æ¢ä¸ºä¸€ä¸ªpromise)ã€‚å®ƒçš„çŠ¶æ€ç”±è¿™ä¸‰ä¸ªpromiseå®ä¾‹å†³å®š</li>
</ul>
<h5 id="race">.race()</h5>
<ul>
<li><code>Promise.race</code>æ–¹æ³•åŒæ ·æ¥å—ä¸€ä¸ªæ•°ç»„ä½œå‚æ•°ã€‚å½“p1, p2, p3ä¸­æœ‰ä¸€ä¸ªå®ä¾‹çš„çŠ¶æ€å‘ç”Ÿæ”¹å˜ï¼ˆå˜ä¸º<code>fulfilled</code>æˆ–<code>rejected</code>ï¼‰ï¼Œpçš„çŠ¶æ€å°±è·Ÿç€æ”¹å˜ã€‚å¹¶æŠŠç¬¬ä¸€ä¸ªæ”¹å˜çŠ¶æ€çš„promiseçš„è¿”å›å€¼ï¼Œä¼ ç»™pçš„å›è°ƒå‡½æ•°</li>
</ul>
<p>â€‹</p>
<pre><code class="language-html">  &lt;script type=&quot;text/javascript&quot;&gt;
    /*
      Promiseå¸¸ç”¨API-å¯¹è±¡æ–¹æ³•
    */
    // console.dir(Promise)
    function queryData(url) {
      return new Promise(function(resolve, reject){
        var xhr = new XMLHttpRequest();
        xhr.onreadystatechange = function(){
          if(xhr.readyState != 4) return;
          if(xhr.readyState == 4 &amp;&amp; xhr.status == 200) {
            // å¤„ç†æ­£å¸¸çš„æƒ…å†µ
            resolve(xhr.responseText);
          }else{
            // å¤„ç†å¼‚å¸¸æƒ…å†µ
            reject('æœåŠ¡å™¨é”™è¯¯');
          }
        };
        xhr.open('get', url);
        xhr.send(null);
      });
    }

    var p1 = queryData('http://localhost:3000/a1');
    var p2 = queryData('http://localhost:3000/a2');
    var p3 = queryData('http://localhost:3000/a3');
     Promise.all([p1,p2,p3]).then(function(result){
       //   all ä¸­çš„å‚æ•°  [p1,p2,p3]   å’Œ è¿”å›çš„ç»“æœä¸€ ä¸€å¯¹åº”[&quot;HELLO TOM&quot;, &quot;HELLO JERRY&quot;, &quot;HELLO SPIKE&quot;]
       console.log(result) //[&quot;HELLO TOM&quot;, &quot;HELLO JERRY&quot;, &quot;HELLO SPIKE&quot;]
     })
    Promise.race([p1,p2,p3]).then(function(result){
      // ç”±äºp1æ‰§è¡Œè¾ƒå¿«ï¼ŒPromiseçš„then()å°†è·å¾—ç»“æœ'P1'ã€‚p2,p3ä»åœ¨ç»§ç»­æ‰§è¡Œï¼Œä½†æ‰§è¡Œç»“æœå°†è¢«ä¸¢å¼ƒã€‚
      console.log(result) // &quot;HELLO TOM&quot;
    })
  &lt;/script&gt;
</code></pre>
<h3 id="fetch">fetch</h3>
<ul>
<li>Fetch APIæ˜¯æ–°çš„ajaxè§£å†³æ–¹æ¡ˆ Fetchä¼šè¿”å›Promise</li>
<li><strong>fetchä¸æ˜¯ajaxçš„è¿›ä¸€æ­¥å°è£…ï¼Œè€Œæ˜¯åŸç”Ÿjsï¼Œæ²¡æœ‰ä½¿ç”¨XMLHttpRequestå¯¹è±¡</strong>ã€‚</li>
<li>fetch(url, options).then(ï¼‰</li>
</ul>
<pre><code class="language-html">  &lt;script type=&quot;text/javascript&quot;&gt;
    /*
      Fetch API åŸºæœ¬ç”¨æ³•
      	fetch(url).then()
     	ç¬¬ä¸€ä¸ªå‚æ•°è¯·æ±‚çš„è·¯å¾„   Fetchä¼šè¿”å›Promise   æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨then æ‹¿åˆ°è¯·æ±‚æˆåŠŸçš„ç»“æœ 
    */
    fetch('http://localhost:3000/fdata').then(function(data){
      // text()æ–¹æ³•å±äºfetchAPIçš„ä¸€éƒ¨åˆ†ï¼Œå®ƒè¿”å›ä¸€ä¸ªPromiseå®ä¾‹å¯¹è±¡ï¼Œç”¨äºè·å–åå°è¿”å›çš„æ•°æ®
      return data.text();
    }).then(function(data){
      //   åœ¨è¿™ä¸ªthené‡Œé¢æˆ‘ä»¬èƒ½æ‹¿åˆ°æœ€ç»ˆçš„æ•°æ®  
      console.log(data);
    })
  &lt;/script&gt;
</code></pre>
<h4 id="fetch-api-ä¸­çš„-http-è¯·æ±‚">fetch API  ä¸­çš„ HTTP  è¯·æ±‚</h4>
<ul>
<li>fetch(url, options).then(ï¼‰</li>
<li>HTTPåè®®ï¼Œå®ƒç»™æˆ‘ä»¬æä¾›äº†å¾ˆå¤šçš„æ–¹æ³•ï¼Œå¦‚POSTï¼ŒGETï¼ŒDELETEï¼ŒUPDATEï¼ŒPATCHå’ŒPUT
<ul>
<li>é»˜è®¤çš„æ˜¯ GET è¯·æ±‚</li>
<li>éœ€è¦åœ¨ options å¯¹è±¡ä¸­ æŒ‡å®šå¯¹åº”çš„ method       method:è¯·æ±‚ä½¿ç”¨çš„æ–¹æ³•</li>
<li>post å’Œ æ™®é€š è¯·æ±‚çš„æ—¶å€™ éœ€è¦åœ¨options ä¸­ è®¾ç½®  è¯·æ±‚å¤´ headers   å’Œ  body</li>
</ul>
</li>
</ul>
<pre><code class="language-html">   &lt;script type=&quot;text/javascript&quot;&gt;
        /*
              Fetch API è°ƒç”¨æ¥å£ä¼ é€’å‚æ•°
        */
       #1.1 GETå‚æ•°ä¼ é€’ - ä¼ ç»ŸURL  é€šè¿‡url  ï¼Ÿ çš„å½¢å¼ä¼ å‚ 
        fetch('http://localhost:3000/books?id=123', {
            	# get è¯·æ±‚å¯ä»¥çœç•¥ä¸å†™ é»˜è®¤çš„æ˜¯GET 
                method: 'get'
            })
            .then(function(data) {
            	# å®ƒè¿”å›ä¸€ä¸ªPromiseå®ä¾‹å¯¹è±¡ï¼Œç”¨äºè·å–åå°è¿”å›çš„æ•°æ®
                return data.text();
            }).then(function(data) {
            	# åœ¨è¿™ä¸ªthené‡Œé¢æˆ‘ä»¬èƒ½æ‹¿åˆ°æœ€ç»ˆçš„æ•°æ®  
                console.log(data)
            });

      #1.2  GETå‚æ•°ä¼ é€’  restfulå½¢å¼çš„URL  é€šè¿‡/ çš„å½¢å¼ä¼ é€’å‚æ•°  å³  id = 456 å’Œidåå°çš„é…ç½®æœ‰å…³   
        fetch('http://localhost:3000/books/456', {
            	# get è¯·æ±‚å¯ä»¥çœç•¥ä¸å†™ é»˜è®¤çš„æ˜¯GET 
                method: 'get'
            })
            .then(function(data) {
                return data.text();
            }).then(function(data) {
                console.log(data)
            });

       #2.1  DELETEè¯·æ±‚æ–¹å¼å‚æ•°ä¼ é€’      åˆ é™¤id  æ˜¯  id=789
        fetch('http://localhost:3000/books/789', {
                method: 'delete'
            })
            .then(function(data) {
                return data.text();
            }).then(function(data) {
                console.log(data)
            });

       #3 POSTè¯·æ±‚ä¼ å‚
        fetch('http://localhost:3000/books', {
                method: 'post',
            	# 3.1  ä¼ é€’æ•°æ® 
                body: 'uname=lisi&amp;pwd=123',
            	#  3.2  è®¾ç½®è¯·æ±‚å¤´ 
                headers: {
                    'Content-Type': 'application/x-www-form-urlencoded'
                }
            })
            .then(function(data) {
                return data.text();
            }).then(function(data) {
                console.log(data)
            });

       # POSTè¯·æ±‚ä¼ å‚
        fetch('http://localhost:3000/books', {
                method: 'post',
                body: JSON.stringify({
                    uname: 'å¼ ä¸‰',
                    pwd: '456'
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(function(data) {
                return data.text();
            }).then(function(data) {
                console.log(data)
            });

        # PUTè¯·æ±‚ä¼ å‚     ä¿®æ”¹id æ˜¯ 123 çš„ 
        fetch('http://localhost:3000/books/123', {
                method: 'put',
                body: JSON.stringify({
                    uname: 'å¼ ä¸‰',
                    pwd: '789'
                }),
                headers: {
                    'Content-Type': 'application/json'
                }
            })
            .then(function(data) {
                return data.text();
            }).then(function(data) {
                console.log(data)
            });
    &lt;/script&gt;
</code></pre>
<h4 id="fetchapi-ä¸­-å“åº”æ ¼å¼">fetchAPI ä¸­ å“åº”æ ¼å¼</h4>
<ul>
<li>ç”¨fetchæ¥è·å–æ•°æ®ï¼Œå¦‚æœå“åº”æ­£å¸¸è¿”å›ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹åˆ°çš„æ˜¯ä¸€ä¸ªresponseå¯¹è±¡ï¼Œå…¶ä¸­åŒ…æ‹¬è¿”å›çš„ä¸€å †åŸå§‹å­—èŠ‚ï¼Œè¿™äº›å­—èŠ‚éœ€è¦åœ¨æ”¶åˆ°åï¼Œéœ€è¦æˆ‘ä»¬é€šè¿‡è°ƒç”¨æ–¹æ³•å°†å…¶è½¬æ¢ä¸ºç›¸åº”æ ¼å¼çš„æ•°æ®ï¼Œæ¯”å¦‚<code>JSON</code>ï¼Œ<code>BLOB</code>æˆ–è€…<code>TEXT</code>ç­‰ç­‰</li>
</ul>
<pre><code class="language-js">
    /*
      Fetchå“åº”ç»“æœçš„æ•°æ®æ ¼å¼
    */
    fetch('http://localhost:3000/json').then(function(data){
      // return data.json();   //  å°†è·å–åˆ°çš„æ•°æ®ä½¿ç”¨ json è½¬æ¢å¯¹è±¡
      return data.text(); //  //  å°†è·å–åˆ°çš„æ•°æ® è½¬æ¢æˆå­—ç¬¦ä¸² 
    }).then(function(data){
      // console.log(data.uname)
      // console.log(typeof data)
      var obj = JSON.parse(data);
      console.log(obj.uname,obj.age,obj.gender)
    })

</code></pre>
<h3 id="axios">axios</h3>
<ul>
<li>åŸºäºpromiseç”¨äºæµè§ˆå™¨å’Œnode.jsçš„httpå®¢æˆ·ç«¯</li>
<li>æ”¯æŒæµè§ˆå™¨å’Œnode.js</li>
<li>æ”¯æŒpromise</li>
<li>èƒ½æ‹¦æˆªè¯·æ±‚å’Œå“åº”</li>
<li>è‡ªåŠ¨è½¬æ¢JSONæ•°æ®</li>
<li>èƒ½è½¬æ¢è¯·æ±‚å’Œå“åº”æ•°æ®</li>
</ul>
<h4 id="axiosåŸºç¡€ç”¨æ³•">axiosåŸºç¡€ç”¨æ³•</h4>
<ul>
<li>getå’Œ deleteè¯·æ±‚ä¼ é€’å‚æ•°
<ul>
<li>é€šè¿‡ä¼ ç»Ÿçš„url  ä»¥ ? çš„å½¢å¼ä¼ é€’å‚æ•°</li>
<li>restful å½¢å¼ä¼ é€’å‚æ•°</li>
<li>é€šè¿‡params  å½¢å¼ä¼ é€’å‚æ•°</li>
</ul>
</li>
<li>post  å’Œ put  è¯·æ±‚ä¼ é€’å‚æ•°
<ul>
<li>é€šè¿‡é€‰é¡¹ä¼ é€’å‚æ•°</li>
<li>é€šè¿‡ URLSearchParams  ä¼ é€’å‚æ•°</li>
</ul>
</li>
</ul>
<pre><code class="language-js">    # 1. å‘é€get è¯·æ±‚ 
	axios.get('http://localhost:3000/adata').then(function(ret){ 
      #  æ‹¿åˆ° ret æ˜¯ä¸€ä¸ªå¯¹è±¡      æ‰€æœ‰çš„å¯¹è±¡éƒ½å­˜åœ¨ ret çš„data å±æ€§é‡Œé¢
      // æ³¨æ„dataå±æ€§æ˜¯å›ºå®šçš„ç”¨æ³•ï¼Œç”¨äºè·å–åå°çš„å®é™…æ•°æ®
      // console.log(ret.data)
      console.log(ret)
    })
	# 2.  get è¯·æ±‚ä¼ é€’å‚æ•°
    # 2.1  é€šè¿‡ä¼ ç»Ÿçš„url  ä»¥ ? çš„å½¢å¼ä¼ é€’å‚æ•°
	axios.get('http://localhost:3000/axios?id=123').then(function(ret){
      console.log(ret.data)
    })
    # 2.2  restful å½¢å¼ä¼ é€’å‚æ•° 
    axios.get('http://localhost:3000/axios/123').then(function(ret){
      console.log(ret.data)
    })
	# 2.3  é€šè¿‡params  å½¢å¼ä¼ é€’å‚æ•° 
    axios.get('http://localhost:3000/axios', {
      params: {
        id: 789
      }
    }).then(function(ret){
      console.log(ret.data)
    })
	#3 axios delete è¯·æ±‚ä¼ å‚     ä¼ å‚çš„å½¢å¼å’Œ get è¯·æ±‚ä¸€æ ·
    axios.delete('http://localhost:3000/axios', {
      params: {
        id: 111
      }
    }).then(function(ret){
      console.log(ret.data)
    })

	# 4  axios çš„ post è¯·æ±‚
    # 4.1  é€šè¿‡é€‰é¡¹ä¼ é€’å‚æ•°
    axios.post('http://localhost:3000/axios', {
      uname: 'lisi',
      pwd: 123
    }).then(function(ret){
      console.log(ret.data)
    })
	# 4.2  é€šè¿‡ URLSearchParams  ä¼ é€’å‚æ•° 
    var params = new URLSearchParams();
    params.append('uname', 'zhangsan');
    params.append('pwd', '111');
    axios.post('http://localhost:3000/axios', params).then(function(ret){
      console.log(ret.data)
    })

 	#5  axios put è¯·æ±‚ä¼ å‚   å’Œ post è¯·æ±‚ä¸€æ · 
    axios.put('http://localhost:3000/axios/123', {
      uname: 'lisi',
      pwd: 123
    }).then(function(ret){
      console.log(ret.data)
    })

</code></pre>
<h4 id="axios-å…¨å±€é…ç½®">axios å…¨å±€é…ç½®</h4>
<pre><code class="language-js">#  é…ç½®å…¬å…±çš„è¯·æ±‚å¤´ 
axios.defaults.baseURL = 'https://api.example.com';
#  é…ç½® è¶…æ—¶æ—¶é—´
axios.defaults.timeout = 2500;
#  é…ç½®å…¬å…±çš„è¯·æ±‚å¤´
axios.defaults.headers.common['Authorization'] = AUTH_TOKEN;
# é…ç½®å…¬å…±çš„ post çš„ Content-Type
axios.defaults.headers.post['Content-Type'] = 'application/x-www-form-urlencoded';


</code></pre>
<h4 id="axios-æ‹¦æˆªå™¨">axios æ‹¦æˆªå™¨</h4>
<ul>
<li>è¯·æ±‚æ‹¦æˆªå™¨
<ul>
<li>è¯·æ±‚æ‹¦æˆªå™¨çš„ä½œç”¨æ˜¯åœ¨è¯·æ±‚å‘é€å‰è¿›è¡Œä¸€äº›æ“ä½œ
<ul>
<li>ä¾‹å¦‚åœ¨æ¯ä¸ªè¯·æ±‚ä½“é‡ŒåŠ ä¸Štokenï¼Œç»Ÿä¸€åšäº†å¤„ç†å¦‚æœä»¥åè¦æ”¹ä¹Ÿéå¸¸å®¹æ˜“</li>
</ul>
</li>
</ul>
</li>
<li>å“åº”æ‹¦æˆªå™¨
<ul>
<li>å“åº”æ‹¦æˆªå™¨çš„ä½œç”¨æ˜¯åœ¨æ¥æ”¶åˆ°å“åº”åè¿›è¡Œä¸€äº›æ“ä½œ
<ul>
<li>ä¾‹å¦‚åœ¨æœåŠ¡å™¨è¿”å›ç™»å½•çŠ¶æ€å¤±æ•ˆï¼Œéœ€è¦é‡æ–°ç™»å½•çš„æ—¶å€™ï¼Œè·³è½¬åˆ°ç™»å½•é¡µ</li>
</ul>
</li>
</ul>
</li>
</ul>
<pre><code class="language-js">	# 1. è¯·æ±‚æ‹¦æˆªå™¨ 
	axios.interceptors.request.use(function(config) {
      console.log(config.url)
      # 1.1  ä»»ä½•è¯·æ±‚éƒ½ä¼šç»è¿‡è¿™ä¸€æ­¥   åœ¨å‘é€è¯·æ±‚ä¹‹å‰åšäº›ä»€ä¹ˆ   
      config.headers.mytoken = 'nihao';
      # 1.2  è¿™é‡Œä¸€å®šè¦return   å¦åˆ™é…ç½®ä¸æˆåŠŸ  
      return config;
    }, function(err){
       #1.3 å¯¹è¯·æ±‚é”™è¯¯åšç‚¹ä»€ä¹ˆ    
      console.log(err)
    })
	#2. å“åº”æ‹¦æˆªå™¨ 
    axios.interceptors.response.use(function(res) {
      #2.1  åœ¨æ¥æ”¶å“åº”åšäº›ä»€ä¹ˆ  
      var data = res.data;
      return data;
    }, function(err){
      #2.2 å¯¹å“åº”é”™è¯¯åšç‚¹ä»€ä¹ˆ  
      console.log(err)
    })
</code></pre>
<h3 id="async-å’Œ-await">async  å’Œ await</h3>
<ul>
<li>asyncä½œä¸ºä¸€ä¸ªå…³é”®å­—æ”¾åˆ°å‡½æ•°å‰é¢
<ul>
<li>ä»»ä½•ä¸€ä¸ª<code>async</code>å‡½æ•°éƒ½ä¼šéšå¼è¿”å›ä¸€ä¸ª<code>promise</code></li>
</ul>
</li>
<li><code>await</code>å…³é”®å­—åªèƒ½åœ¨ä½¿ç”¨<code>async</code>å®šä¹‰çš„å‡½æ•°ä¸­ä½¿ç”¨
<ul>
<li>â€‹    awaitåé¢å¯ä»¥ç›´æ¥è·Ÿä¸€ä¸ª Promiseå®ä¾‹å¯¹è±¡</li>
<li>â€‹     awaitå‡½æ•°ä¸èƒ½å•ç‹¬ä½¿ç”¨</li>
</ul>
</li>
<li><strong>async/await è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥ã€è¡¨ç°èµ·æ¥æ›´åƒåŒæ­¥ä»£ç </strong></li>
</ul>
<pre><code class="language-js"> 	# 1.  async åŸºç¡€ç”¨æ³•
    # 1.1 asyncä½œä¸ºä¸€ä¸ªå…³é”®å­—æ”¾åˆ°å‡½æ•°å‰é¢
	async function queryData() {
      # 1.2 awaitå…³é”®å­—åªèƒ½åœ¨ä½¿ç”¨asyncå®šä¹‰çš„å‡½æ•°ä¸­ä½¿ç”¨      awaitåé¢å¯ä»¥ç›´æ¥è·Ÿä¸€ä¸ª Promiseå®ä¾‹å¯¹è±¡
      var ret = await new Promise(function(resolve, reject){
        setTimeout(function(){
          resolve('nihao')
        },1000);
      })
      // console.log(ret.data)
      return ret;
    }
	# 1.3 ä»»ä½•ä¸€ä¸ªasyncå‡½æ•°éƒ½ä¼šéšå¼è¿”å›ä¸€ä¸ªpromise   æˆ‘ä»¬å¯ä»¥ä½¿ç”¨then è¿›è¡Œé“¾å¼ç¼–ç¨‹
    queryData().then(function(data){
      console.log(data)
    })

	#2.  async    å‡½æ•°å¤„ç†å¤šä¸ªå¼‚æ­¥å‡½æ•°
    axios.defaults.baseURL = 'http://localhost:3000';

    async function queryData() {
      # 2.1  æ·»åŠ awaitä¹‹å å½“å‰çš„await è¿”å›ç»“æœä¹‹åæ‰ä¼šæ‰§è¡Œåé¢çš„ä»£ç    
      
      var info = await axios.get('async1');
      #2.2  è®©å¼‚æ­¥ä»£ç çœ‹èµ·æ¥ã€è¡¨ç°èµ·æ¥æ›´åƒåŒæ­¥ä»£ç 
      var ret = await axios.get('async2?info=' + info.data);
      return ret.data;
    }

    queryData().then(function(data){
      console.log(data)
    })
</code></pre>
<h3 id="å›¾ä¹¦åˆ—è¡¨æ¡ˆä¾‹">å›¾ä¹¦åˆ—è¡¨æ¡ˆä¾‹</h3>
<h4 id="1-åŸºäºæ¥å£æ¡ˆä¾‹-è·å–å›¾ä¹¦åˆ—è¡¨">1. åŸºäºæ¥å£æ¡ˆä¾‹-è·å–å›¾ä¹¦åˆ—è¡¨</h4>
<ul>
<li>å¯¼å…¥axios   ç”¨æ¥å‘é€ajax</li>
<li>æŠŠè·å–åˆ°çš„æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Š</li>
</ul>
<pre><code class="language-html">  &lt;div id=&quot;app&quot;&gt;
        &lt;div class=&quot;grid&quot;&gt;
            &lt;table&gt;
                &lt;thead&gt;
                    &lt;tr&gt;
                        &lt;th&gt;ç¼–å·&lt;/th&gt;
                        &lt;th&gt;åç§°&lt;/th&gt;
                        &lt;th&gt;æ—¶é—´&lt;/th&gt;
                        &lt;th&gt;æ“ä½œ&lt;/th&gt;
                    &lt;/tr&gt;
                &lt;/thead&gt;
                &lt;tbody&gt;
                    &lt;!-- 5.  æŠŠbooks  ä¸­çš„æ•°æ®æ¸²æŸ“åˆ°é¡µé¢ä¸Š   --&gt;
                    &lt;tr :key='item.id' v-for='item in books'&gt;
                        &lt;td&gt;{{item.id}}&lt;/td&gt;
                        &lt;td&gt;{{item.name}}&lt;/td&gt;
                        &lt;td&gt;{{item.date }}&lt;/td&gt;
                        &lt;td&gt;
                            &lt;a href=&quot;&quot;&gt;ä¿®æ”¹&lt;/a&gt;
                            &lt;span&gt;|&lt;/span&gt;
                            &lt;a href=&quot;&quot;&gt;åˆ é™¤&lt;/a&gt;
                        &lt;/td&gt;
                    &lt;/tr&gt;
                &lt;/tbody&gt;
            &lt;/table&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;script type=&quot;text/javascript&quot; src=&quot;js/vue.js&quot;&gt;&lt;/script&gt;
	1.  å¯¼å…¥axios   
    &lt;script type=&quot;text/javascript&quot; src=&quot;js/axios.js&quot;&gt;&lt;/script&gt;
    &lt;script type=&quot;text/javascript&quot;&gt;
        /*
             å›¾ä¹¦ç®¡ç†-æ·»åŠ å›¾ä¹¦
         */
        # 2   é…ç½®å…¬å…±çš„urlåœ°å€  ç®€åŒ–åé¢çš„è°ƒç”¨æ–¹å¼
        axios.defaults.baseURL = 'http://localhost:3000/';
        axios.interceptors.response.use(function(res) {
            return res.data;
        }, function(error) {
            console.log(error)
        });

        var vm = new Vue({
            el: '#app',
            data: {
                flag: false,
                submitFlag: false,
                id: '',
                name: '',
                books: []
            },
            methods: {
                # 3 å®šä¹‰ä¸€ä¸ªæ–¹æ³• ç”¨æ¥å‘é€ ajax 
                # 3.1  ä½¿ç”¨ async  æ¥ è®©å¼‚æ­¥çš„ä»£ç   ä»¥åŒæ­¥çš„å½¢å¼ä¹¦å†™ 
                queryData: async function() {
                    // è°ƒç”¨åå°æ¥å£è·å–å›¾ä¹¦åˆ—è¡¨æ•°æ®
                    // var ret = await axios.get('books');
                    // this.books = ret.data;
					# 3.2  å‘é€ajaxè¯·æ±‚  æŠŠæ‹¿åˆ°çš„æ•°æ®æ”¾åœ¨books é‡Œé¢   
                    this.books = await axios.get('books');
                }
            },

            mounted: function() {
				#  4 mounted  é‡Œé¢ DOMå·²ç»åŠ è½½å®Œæ¯•  åœ¨è¿™é‡Œè°ƒç”¨å‡½æ•°  
                this.queryData();
            }
        });
    &lt;/script&gt;
</code></pre>
<h4 id="2-æ·»åŠ å›¾ä¹¦">2   æ·»åŠ å›¾ä¹¦</h4>
<ul>
<li>è·å–ç”¨æˆ·è¾“å…¥çš„æ•°æ®   å‘é€åˆ°åå°</li>
<li>æ¸²æŸ“æœ€æ–°çš„æ•°æ®åˆ°é¡µé¢ä¸Š</li>
</ul>
<pre><code class="language-js"> methods: {
    handle: async function(){
          if(this.flag) {
            // ç¼–è¾‘å›¾ä¹¦
            // å°±æ˜¯æ ¹æ®å½“å‰çš„IDå»æ›´æ–°æ•°ç»„ä¸­å¯¹åº”çš„æ•°æ®
            this.books.some((item) =&gt; {
              if(item.id == this.id) {
                item.name = this.name;
                // å®Œæˆæ›´æ–°æ“ä½œä¹‹åï¼Œéœ€è¦ç»ˆæ­¢å¾ªç¯
                return true;
              }
            });
            this.flag = false;
          }else{
            # 1.1  åœ¨å‰é¢å°è£…å¥½çš„ handle æ–¹æ³•ä¸­  å‘é€ajaxè¯·æ±‚  
            # 1.2  ä½¿ç”¨async  å’Œ await ç®€åŒ–æ“ä½œ éœ€è¦åœ¨ function å‰é¢æ·»åŠ  async   
            var ret = await axios.post('books', {
              name: this.name
            })
            # 1.3  æ ¹æ®åå°è¿”å›çš„çŠ¶æ€ç åˆ¤æ–­æ˜¯å¦åŠ è½½æ•°æ® 
            if(ret.status == 200) {
             # 1.4  è°ƒç”¨ queryData è¿™ä¸ªæ–¹æ³•  æ¸²æŸ“æœ€æ–°çš„æ•°æ® 
              this.queryData();
            }
          }
          // æ¸…ç©ºè¡¨å•
          this.id = '';
          this.name = '';
        },        
 }         
</code></pre>
<h4 id="3-éªŒè¯å›¾ä¹¦åç§°æ˜¯å¦å­˜åœ¨">3  éªŒè¯å›¾ä¹¦åç§°æ˜¯å¦å­˜åœ¨</h4>
<ul>
<li>æ·»åŠ å›¾ä¹¦ä¹‹å‰å‘é€è¯·æ±‚éªŒè¯å›¾ç¤ºæ˜¯å¦å·²ç»å­˜åœ¨</li>
<li>å¦‚æœä¸å­˜åœ¨ å¾€åå°é‡Œé¢æ·»åŠ å›¾ä¹¦åç§°
<ul>
<li>å›¾ä¹¦å­˜åœ¨ä¸å¦åªéœ€è¦ä¿®æ”¹submitFlagçš„å€¼å³å¯</li>
</ul>
</li>
</ul>
<pre><code class="language-js"> watch: {
        name: async function(val) {
          // éªŒè¯å›¾ä¹¦åç§°æ˜¯å¦å·²ç»å­˜åœ¨
          // var flag = this.books.some(function(item){
          //   return item.name == val;
          // });
          var ret = await axios.get('/books/book/' + this.name);
          if(ret.status == 1) {
            // å›¾ä¹¦åç§°å­˜åœ¨
            this.submitFlag = true;
          }else{
            // å›¾ä¹¦åç§°ä¸å­˜åœ¨
            this.submitFlag = false;
          }
        }
},
</code></pre>
<h4 id="4-ç¼–è¾‘å›¾ä¹¦">4.  ç¼–è¾‘å›¾ä¹¦</h4>
<ul>
<li>æ ¹æ®å½“å‰ä¹¦çš„id æŸ¥è¯¢éœ€è¦ç¼–è¾‘çš„ä¹¦ç±</li>
<li>éœ€è¦æ ¹æ®çŠ¶æ€ä½åˆ¤æ–­æ˜¯æ·»åŠ è¿˜æ˜¯ç¼–è¾‘</li>
</ul>
<pre><code class="language-js"> methods: {
        handle: async function(){
          if(this.flag) {
            #4.3 ç¼–è¾‘å›¾ä¹¦   æŠŠç”¨æˆ·è¾“å…¥çš„ä¿¡æ¯æäº¤åˆ°åå°
            var ret = await axios.put('books/' + this.id, {
              name: this.name
            });
            if(ret.status == 200){
              #4.4  å®Œæˆæ·»åŠ å é‡æ–°åŠ è½½åˆ—è¡¨æ•°æ®
              this.queryData();
            }
            this.flag = false;
          }else{
            // æ·»åŠ å›¾ä¹¦
            var ret = await axios.post('books', {
              name: this.name
            })
            if(ret.status == 200) {
              // é‡æ–°åŠ è½½åˆ—è¡¨æ•°æ®
              this.queryData();
            }
          }
          // æ¸…ç©ºè¡¨å•
          this.id = '';
          this.name = '';
        },
        toEdit: async function(id){
          #4.1  flagçŠ¶æ€ä½ç”¨äºåŒºåˆ†ç¼–è¾‘å’Œæ·»åŠ æ“ä½œ
          this.flag = true;
          #4.2  æ ¹æ®idæŸ¥è¯¢å‡ºå¯¹åº”çš„å›¾ä¹¦ä¿¡æ¯  é¡µé¢ä¸­å¯ä»¥åŠ è½½å‡ºæ¥æœ€æ–°çš„ä¿¡æ¯
          # è°ƒç”¨æ¥å£å‘é€ajax è¯·æ±‚  
          var ret = await axios.get('books/' + id);
          this.id = ret.id;
          this.name = ret.name;
        },
</code></pre>
<h4 id="5-åˆ é™¤å›¾ä¹¦">5 åˆ é™¤å›¾ä¹¦</h4>
<ul>
<li>æŠŠéœ€è¦åˆ é™¤çš„idä¹¦ç± é€šè¿‡å‚æ•°çš„å½¢å¼ä¼ é€’åˆ°åå°</li>
</ul>
<pre><code class="language-js">   deleteBook: async function(id){
          // åˆ é™¤å›¾ä¹¦
          var ret = await axios.delete('books/' + id);
          if(ret.status == 200) {
            // é‡æ–°åŠ è½½åˆ—è¡¨æ•°æ®
            this.queryData();
          }
   }
</code></pre>
]]></content>
    </entry>
    <entry>
        <title type="html"><![CDATA[Hello Gridea]]></title>
        <id>https://lainbo.github.io//post/hello-gridea</id>
        <link href="https://lainbo.github.io//post/hello-gridea">
        </link>
        <updated>2018-12-11T16:00:00.000Z</updated>
        <summary type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
]]></summary>
        <content type="html"><![CDATA[<p>ğŸ‘  æ¬¢è¿ä½¿ç”¨ <strong>Gridea</strong> ï¼<br>
âœï¸  <strong>Gridea</strong> ä¸€ä¸ªé™æ€åšå®¢å†™ä½œå®¢æˆ·ç«¯ã€‚ä½ å¯ä»¥ç”¨å®ƒæ¥è®°å½•ä½ çš„ç”Ÿæ´»ã€å¿ƒæƒ…ã€çŸ¥è¯†ã€ç¬”è®°ã€åˆ›æ„... ...</p>
<!-- more -->
<p><a href="https://github.com/getgridea/gridea">Github</a><br>
<a href="https://gridea.dev/">Gridea ä¸»é¡µ</a><br>
<a href="http://fehey.com/">ç¤ºä¾‹ç½‘ç«™</a></p>
<h2 id="ç‰¹æ€§">ç‰¹æ€§ğŸ‘‡</h2>
<p>ğŸ“  ä½ å¯ä»¥ä½¿ç”¨æœ€é…·çš„ <strong>Markdown</strong> è¯­æ³•ï¼Œè¿›è¡Œå¿«é€Ÿåˆ›ä½œ</p>
<p>ğŸŒ‰  ä½ 11111å¯ä»¥ç»™æ–‡ç« é…ä¸Šç²¾ç¾çš„å°é¢å›¾å’Œåœ¨æ–‡ç« ä»»æ„ä½ç½®æ’å…¥å›¾ç‰‡</p>
<p>ğŸ·ï¸  ä½ å¯ä»¥å¯¹æ–‡ç« è¿›è¡Œæ ‡ç­¾åˆ†ç»„</p>
<p>ğŸ“‹  ä½ å¯ä»¥è‡ªå®šä¹‰èœå•ï¼Œç”šè‡³å¯ä»¥åˆ›å»ºå¤–éƒ¨é“¾æ¥èœå•</p>
<p>ğŸ’»  ä½ å¯ä»¥åœ¨ <strong>Windows</strong>ï¼Œ<strong>MacOS</strong> æˆ– <strong>Linux</strong> è®¾å¤‡ä¸Šä½¿ç”¨æ­¤å®¢æˆ·ç«¯</p>
<p>ğŸŒ  ä½ å¯ä»¥ä½¿ç”¨ <strong>ğ–¦ğ—‚ğ—ğ—ğ—ğ–» ğ–¯ğ–ºğ—€ğ–¾ğ—Œ</strong> æˆ– <strong>Coding Pages</strong> å‘ä¸–ç•Œå±•ç¤ºï¼Œæœªæ¥å°†æ”¯æŒæ›´å¤šå¹³å°</p>
<p>ğŸ’¬  ä½ å¯ä»¥è¿›è¡Œç®€å•çš„é…ç½®ï¼Œæ¥å…¥ <a href="https://github.com/gitalk/gitalk">Gitalk</a> æˆ– <a href="https://github.com/SukkaW/DisqusJS">DisqusJS</a> è¯„è®ºç³»ç»Ÿ</p>
<p>ğŸ‡¬ğŸ‡§  ä½ å¯ä»¥ä½¿ç”¨<strong>ä¸­æ–‡ç®€ä½“</strong>æˆ–<strong>è‹±è¯­</strong></p>
<p>ğŸŒ  ä½ å¯ä»¥ä»»æ„ä½¿ç”¨åº”ç”¨å†…é»˜è®¤ä¸»é¢˜æˆ–ä»»æ„ç¬¬ä¸‰æ–¹ä¸»é¢˜ï¼Œå¼ºå¤§çš„ä¸»é¢˜è‡ªå®šä¹‰èƒ½åŠ›</p>
<p>ğŸ–¥  ä½ å¯ä»¥è‡ªå®šä¹‰æºæ–‡ä»¶å¤¹ï¼Œåˆ©ç”¨ OneDriveã€ç™¾åº¦ç½‘ç›˜ã€iCloudã€Dropbox ç­‰è¿›è¡Œå¤šè®¾å¤‡åŒæ­¥</p>
<p>ğŸŒ± å½“ç„¶ <strong>Gridea</strong> è¿˜å¾ˆå¹´è½»ï¼Œæœ‰å¾ˆå¤šä¸è¶³ï¼Œä½†è¯·ç›¸ä¿¡ï¼Œå®ƒä¼šä¸åœå‘å‰ ğŸƒ</p>
<p>æœªæ¥ï¼Œå®ƒä¸€å®šä¼šæˆä¸ºä½ ç¦»ä¸å¼€çš„ä¼™ä¼´</p>
<p>å°½æƒ…å‘æŒ¥ä½ çš„æ‰åå§ï¼</p>
<p>ğŸ˜˜ Enjoy~</p>
]]></content>
    </entry>
</feed>